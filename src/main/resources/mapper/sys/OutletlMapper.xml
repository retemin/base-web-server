<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.grkj.modules.sys.mapper.OutletlMapper">
    <resultMap id="outletlMap" type="com.grkj.modules.sys.entity.Outletl">
        <id column="oid" property="id"/>
        <result column="otype" property="type"/>
        <result column="outletlname" property="outletlname"/>
        <result column="instrumentid" property="instrumentid"/>
        <result column="instrumentpwd" property="instrumentpwd"/>
        <result column="monitorypoint" property="monitorypoint"/>
        <result column="longitude" property="longitude"/>
        <result column="latitude" property="latitude"/>
        <result column="outletlid" property="outletlid"/>
        <result column="ename" property="ename"/>
        <result column="updateTime" property="updateTime"/>
    </resultMap>
    <select id="getOutletList" parameterType="Map" resultMap="outletlMap">
        select * from
        (select  o.ID oid,o.TYPE otype,o.FLAG flag, o.INSTRUMENTID instrumentid,o.OUTLETLNAME outletlname,o.INSTRUMENTPWD instrumentpwd,o.MONITORYPOINT monitorypoint,
        o.OUTLETLID outletlid, o.LONGITUDE longitude,o.LATITUDE latitude,e.NAME ename,e.ID eid,e.UPDATE_TIME updateTime
        from SYS_ENTERPRISE e
        RIGHT JOIN SYS_OUTLETL o
        ON o.ID = e.ID)

        <where>
            <if test="id!=null and id!='' ">
                AND oid = #{id}
            </if>
            <if test="name!=null and name!=''">
                AND  ename like  '%${name}%'
            </if>
            <if test="type!=null and type!=''">
                AND otype = #{type}
            </if>
            <if test="outletlName!=null and outletlName!=''">
                AND outletlname like '%${outletlName}%'
            </if>
            <if test="instrumentId!=null and instrumentId!=''">
                AND instrumentid like '%${instrumentId}%'
            </if>
        </where>
    order by oid desc

    </select>
    <update id="updateTime" parameterType="java.lang.String">
        update SYS_ENTERPRISE set  UPDATE_TIME = #{time} where ID = #{id}
    </update>
    <select id="getOutletlById" parameterType="java.lang.String" resultType="com.grkj.modules.sys.entity.Outletl">
        select * from SYS_OUTLETL where OUTLETLID = #{id}
    </select>
    <insert id="insertOutletl" parameterType="com.grkj.modules.sys.entity.Outletl">
        insert into SYS_OUTLETL(ID,TYPE,OUTLETLID,FLAG,INSTRUMENTID,INSTRUMENTPWD,MONITORYPOINT,LONGITUDE,LATITUDE)
        VALUES (#{id},#{type},#{outletlid},#{flag},#{instrumentid},#{instrumentpwd},#{monitorypoint},#{longitude},#{latitude})
    </insert>
    <delete id="deleteByOutletlId" parameterType="java.lang.String">
        delete from SYS_OUTLETL where OUTLETLID=#{outletlid}
    </delete>
    <!--<update id="updateOutletFlagById" parameterType="java.lang.String">-->
        <!--update SYS_OUTLETL SET FLAG= #{} where OUTLETLID = #{outl}-->
    <!--</update>-->
</mapper>